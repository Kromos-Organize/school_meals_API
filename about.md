# Сущности БД
* Администратор системы (роли: администратор(S_ADMIN))
* Пользователь системы (роли: администратор школы (ADMIN) / учитель(EMPLOYEE))
* Школа
* Класс
* Ученик 
* Меню 
* Типы меню
* Цена (Результат подсчета суммы)
* Телефоны родителей учеников
* Сессия пользователя

с

## Начальный флоу Администратора

- Администратор школы регистрируется в системе(подает заявку на регистрацию), получает роль админа (`/registration`).
- После регистрации администратор школы, не сможет зайти в кабинет, пока его аккаунт не активирует администратор системы в своем кабинте (изменит поле isActive на true) (`/user/moderation`) либо удалит администратора школы из системы(`/user}`).
- Админ школы авторизуется в системе, получает токены (/login).
- Админ школы добавляет свою школу (`school`), после создания школы, бэк привязвает id школы к администратору. Добавить новую школу он не сможет.
- Админ добавляет учителей школы (`/users`), учителя и сами админы одна сущность - user, но при добавлении учителя, он сразу активен (`isActive: true`).
- Админ добавляет классы которые есть у него в школе (`class`).
- Админ создает учеников (`/student`).
- Админ создает тип меню для своей школы (`/type-menu`).
- Админ при небходимости редактирует данные своего аккаунта (`/user`).

## Ежедневный флоу Администратора
- После получения меню и их цены, добавляет меню и их цену (`/menu`) на основании типа заранее определенного типа для его школы('type_menu')
- В кабинете заходит на страницу автоматического подсчета, (сокет) рассылается уведомления учителям на сматрфоны. (в мобильное приложение)
- При необходимости на другой станице заполняет данные по классу за любого учителя.
- После полечения данных всех классов, с помощью сервиса генерирует отчет и печатает.
- 
## Ежегодный флоу Администратора
- В мае обновляет списки учеников для выпуска / перехода в другой класс
- В сентябре обновляет списки учеников с новыми / убывшими

## Периодический флоу Администратора
- Изменяет телефоны родителей
- Изменяет категорию ученика (isBudget)
- Переводит ученика в параллельный класс

# Флоу Учителя

## Ежедневный флоу Учителя
- Заходит в мобильное приложение, если менять данные по питаю ученика с предыдущего раза не надо, просто нажимает отправить данные.


# Подробное описание сущностей
### *Администратор*
  + Права:
    + Создается самостоятельно(пока самостоятельно)
    + Полный доступ к базе
  + Поля:
    + id: number;
    + email: string
    + password: string;
    + **role**: string;  
    + fname: string;
    + name: string;
    + position: string;
    + chat_number: string;
    

### *Пользователь*
+ Права:
    + Регистрируется (только Админ школы)
    + В роли администратора создает школу, учителей, классы, меню, типы меню, учеников, телефоны родителей
    + В роли учителя отсылает данные для подсчета питания по своему классу
    + В роли администратора требуется активация администратором системы
+ Поля:
    + id: number;
    + school_id: number;
    + **role**: string;
    + email: string;
    + password: string;
    + phone: string;
    + fname: string;
    + name: string;
    + lname: string;
    + birthday: Date;
    + **isActive**: boolean;

### *Школа*
+ Права:
    + Создается пользователем (админом школы)
+ Поля:
    + school_id: number;
    + name: string
    + region: string
    + area: string
    + city: string
    + street: string
    + homeNumber: number

### *Класс*
+ Права:
    + Создается пользователем (админом школы) после создания школы
+ Поля:
    + class_id: number;
    + school_id: number;
    + number: number;
    + type: string;
    + category: ClassCategoryEnum;

### *Ученик*
+ Права:
    + Создается пользователем (админом школы) после создания класса
    + Уровень цен меню определяется по isLargeFamilies
+ Поля:
    + student_id: number;
    + school_id: number;
    + class_id: number;
    + fname: string;
    + name: string;
    + lname: string;
    + birthday: Date;
    + isLargeFamilies: boolean;

### *Меню*
+ Права:
    + Создается пользователем (админом школы) после создания школы / класса
+ Поля:
    + menu_id: number;
    + school_id: number;
    + type_id: number;
    + paid_price: number;
    + free_price: number;
    + date: Date;

### *Тип меню*
+ Права:
    + Создается пользователем (админом школы) до создания меню
    + Типы: Определяются пользователем (админом школы)
+ Поля:
    + type_id: number;
    + school_id: number;
    + type_menu: string;

### *Телефоны родителей учеников*
+ Права:
    + Создается пользователем (админом школы), можно вместе с созданием ученика, либо после
+ Поля:
    + phone_id: number;
    + student_id: number;
    + m_phone: string;
    + f_phone: string;

### *Сессия пользователя*
+ Права:
    + Сохраняет залогиненных пользователей вместе с выдачей в куки рефреш-токена на 30 дней
+ Поля:
    + session_id: number;
    + user_id: number;
    + device_name: string;
    + ip: string;
    + issued_at: Date;
    + last_usage_at: Date;
    + expires_at: Date;
    + logged_out: boolean;